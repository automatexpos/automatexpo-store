{% extends 'base.html' %}
{% block content %}
<form method="post" enctype="multipart/form-data">
<div class="grid payment-grid">
  <!-- Left: Payment Form -->
  <div class="card">
    <h2>Confirm Payment</h2>

      <div class="field">
        <label>Full Name</label>
        <input type="text" name="buyer_name" required>
      </div>
      <div class="field">
        <label>Email</label>
        <input type="email" name="buyer_email" required>
      </div>
      <div class="field">
        <label>Phone</label>
        <input type="text" name="buyer_phone" required>
      </div>
      <div class="field">
        <label>Address</label>
        <input name="buyer_address" required>
      </div>

      <hr>
      <h3>ðŸ’³ Seller Payment Details</h3>
      {% if admin %}
        <div class="field">
          <p><strong>Seller:</strong> {{ admin.username }}</p>
          {% if admin.easypaisa_number %}
            <p><strong>Easypaisa:</strong> {{ admin.easypaisa_number }}</p>
          {% endif %}
          {% if admin.bank_name and admin.bank_account %}
            <p><strong>Bank:</strong> {{ admin.bank_name }} ({{ admin.bank_account }})</p>
          {% endif %}
        </div>

        <div class="field">
          <label>Select Payment Method</label>
          {% if admin.easypaisa_number %}
            <label><input type="radio" name="payment_method" value="easypaisa" required> Easypaisa</label>
          {% endif %}
          {% if admin.bank_account %}
            <label><input type="radio" name="payment_method" value="bank" required> Bank Transfer</label>
          {% endif %}
        </div>
      {% endif %}

      <div class="field">
        <label>Upload Screenshot of Payment</label>
        <input type="file" name="receipt" required>
      </div>
  </div>

  <!-- Right: Order Summary -->
  {% if phones %}
  <div class="card order-summary">
    <h3>ðŸ›’ Order Summary</h3>
    <table class="table">
      <thead>
        <tr>
          <th>Item</th>
          <th>Price</th>
          <th>Qty</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody>
        {% for p in phones %}
        <tr>
          <td>{{ p.model }}</td>
          <td>{{ p.price }}</td>
          <td>1</td>
          <td>{{ p.price }}</td>
        </tr>
        {% endfor %}
      </tbody>
      <tfoot>
        <tr>
          <td colspan="3"><strong>Grand Total</strong></td>
          <td><strong>{{ total_price }}</strong></td>
        </tr>
      </tfoot>
    </table>

    <!-- Submit Button under order summary -->
    <button type="submit" class="btn" style="margin-top: 1rem;">Submit Payment</button>
  </div>
  {% endif %}
</div>
</form>
{% endblock %}
